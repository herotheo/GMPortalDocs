# 2.1配置HTTP2

案例演示：配置HTTP2

演示配置组合如下：

| 客户端到网关使用协议 | 网关到后端服务器使用协议 |
| -------------------- | ------------------------ |
| HTTP1.1              | HTTP1.1                  |
| HTTP1.1              | HTTP2                    |
| HTTP2                | HTTP1.1                  |
| HTTP2                | HTTP2                    |

<p style="color:red;font-weight:bold">
       注:演示以国密通信为例，国际通信不再演示，效果与国密算法相同
</p>

## 2.1.1 客户端到网关HTTP1.1，网关到后端服务器HTTP1.1

> 客户端到网关HTTP1.1，网关到后端服务器HTTP1.1

1. 我们首先将网关使用协议配置为HTTP1.1

2. 接着我们使用奇安信浏览器，"F12"打开控制台，选择网络，并在后端服务器使用tcpdump抓取网关到后端服务器的数据。

   ![image-20220601150341597](../image/image-20220601150341597.png ':size=75%')

3. 接着我们访问[新渡-国密安全WEB网关](https://home.hccie.com:21443/),由图可看出成功建立了国密通信

   ![image-20220601151217143](../image/image-20220601151217143.png ':size=75%')

4. 接着我们在控制台的"Name"列中找到"home.hccie.com"并点击，然后找到"Response Headers"，并点击"View source"

    ![image-20220601150735840](../image/20220601150735840.png  ':size=75%')

   

5. 由图可看出，此次使用的协议是HTTP1.1

   ![image-20220601150735849](../image/image-20220601150735849.png  ':size=75%')

   

6. 接着我们将后端服务器抓取的数据包保存出来，同样使用wireshark进行分析，由图看出，网关到后端服务器使用的协议为HTTP1.1

   ![image-20220601142348802](../image/wg-hdhttp1.png ':size=75%')

## 2.1.2 客户端到网关HTTP1.1，网关到后端服务器HTTP2

> 客户端到网关使用HTTP1.1，网关到后端服务器使用HTTP2

5. 我们接着上面的"2.1.1",这次客户端到网关的使用协议我们不动,仍为HTTP1.1，将网关到后端服务器的协议更改为HTTP2。

6. 再次使用奇安信浏览器进行访问 [新渡-国密安全WEB网关](http://home.hccie.com:21443/)，并使用cpdump抓取对数据进行抓取，抓取的结果如下：

   由图可看出，网关到后端服务器这次使用的协议为HTTP2

   ![image-20220601143936864](../image/WG-HDht2.png ':size=75%')

## 2.1.3 客户端到网关HTTP2，网关到后端服务器HTTP1.1

> 客户端到网关HTTP2，网关到后端服务器HTTP1.1

1. 我们首先将网关使用协议配置为HTTP2

2. 接着我们使用奇安信浏览器，"F12"打开控制台，选择网络，并在后端服务器使用tcpdump抓取网关到后端服务器的数据。

   ![image-20220601150341597](../image/image-20220601150341597.png ':size=75%')

3. 接着我们访问[新渡-国密安全WEB网关](https://home.hccie.com:21443/),由图可看出成功建立了国密通信

   ![image-20220601151217143](../image/image-20220601151217143.png ':size=75%')

4. 接着我们在控制台的"Name"列中找到"home.hccie.com"并点击，然后找到"Response Headers"，并点击"View source"

   图片 todo

5. 由图可看出，此次使用的协议是HTTP2

   图片 todo

   

## 2.1.4 客户端到网关HTTP2，网关到后端服务器HTTP2

> 客户端到网关HTTP2，网关到后端服务器HTTP2

5. 我们接着上面的"2.1.3",这次客户端到网关的使用协议我们不动,仍为HTTP2，将网关到后端服务器的协议更改为HTTP2。

6. 再次使用奇安信浏览器进行访问 [新渡-国密安全WEB网关](http://home.hccie.com:21443/)，并使用cpdump抓取对数据进行抓取，抓取的结果如下：

   由图可看出，网关到后端服务器这次使用的协议为HTTP2

   ![image-20220601143936864](../image/WG-HDht2.png ':size=75%')
